/u/home/galaxy/collaboratory/serghei/code/rop/tools/fastq_quality_filter -v -Q 33 -q 20 -p 75 -i /u/home/galaxy/collaboratory/serghei/code/rop/example/unmappedExample.fastq -o /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_lowQ.fastq > /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_QC.log 

/u/home/galaxy/collaboratory/serghei/code/rop/tools/seqclean-x86_64/seqclean /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_lowQ.fa -l 50 -M -o /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_lowQC.fa 2>>/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_QC.log
/u/home/galaxy/collaboratory/serghei/code/rop/tools/blastn -task megablast -index_name /u/home/galaxy/collaboratory/serghei/code/rop/db/rRNA/rRNA -use_index true -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_lowQC.fa -db /u/home/galaxy/collaboratory/serghei/code/rop/db/rRNA/rRNA  -outfmt 6 -evalue 1e-05  >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_rRNA_blastFormat6.csv
Number of entries in /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_rRNA_blastFormat6.csv is 29
2. Remapping to human references...
/u/home/galaxy/collaboratory/serghei/code/rop/tools/bowtie2 -k 1 -p 8 -f -x /u/home/galaxy/collaboratory/serghei/code/rop/db/human/Bowtie2Index/genome -U /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_after_rRNA.fasta 2>>/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/lostHumanReads/unmappedExample_lostHuman.log | /u/home/galaxy/collaboratory/serghei/code/rop/tools/samtools view -SF4 -   >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/lostHumanReads/unmappedExample_genome.sam
/u/home/galaxy/collaboratory/serghei/code/rop/tools/bowtie2  -k 1 -f -p 8 -x /u/home/galaxy/collaboratory/serghei/code/rop/db/human/Bowtie2Index/hg19KnownGene.exon_polya200 -U /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/QC/unmappedExample_after_rRNA.fasta 2>>/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/lostHumanReads/unmappedExample_lostHuman.log | /u/home/galaxy/collaboratory/serghei/code/rop/tools/samtools view -SF4 -  >  /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/lostHumanReads/unmappedExample_transcriptome.sam 
3. Maping to repeat sequences...
/u/home/galaxy/collaboratory/serghei/code/rop/tools/blastn -task megablast -index_name /u/home/galaxy/collaboratory/serghei/code/rop/db/repeats/human_repbase_20_07/human_repbase_20_07.fa -use_index true -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/lostHumanReads/unmappedExample_after_rRNA_lostHuman.fasta -db /u/home/galaxy/collaboratory/serghei/code/rop/db/repeats/human_repbase_20_07/human_repbase_20_07.fa  -outfmt 6 -evalue 1e-05  > /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/lostRepeatSequences/unmappedExample_lostRepeats_blastFormat6.csv
4. Non-co-linear RNA profiling
5a. B lymphocytes profiling...
/u/home/galaxy/collaboratory/serghei/code/rop/tools/igblastn -germline_db_V /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGHV.fa -germline_db_D /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGHD.fa  -germline_db_J /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGHJ.fa -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/NCL/unmappedExample_after_NCL.fasta -outfmt 7 -evalue 1e-05  2>temp.txt | awk '{if($13<1e-05 && ($1=="V" || $1=="D" || $1=="J")) print }' >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//BCR//IGH/unmappedExample_IGH_igblast.csv
/u/home/galaxy/collaboratory/serghei/code/rop/tools/igblastn -germline_db_V /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGKV.fa -germline_db_D /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGHD.fa  -germline_db_J /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGKJ.fa -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/NCL/unmappedExample_after_NCL.fasta -outfmt 7 -evalue 1e-05 2>temp.txt | awk '{if($13<1e-05 && ($1=="V" || $1=="J")) print }' >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//BCR//IGK/unmappedExample_IGK_igblast.csv
/u/home/galaxy/collaboratory/serghei/code/rop/tools/igblastn -germline_db_V /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGLV.fa -germline_db_D /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGHD.fa  -germline_db_J /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/IGLJ.fa -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/NCL/unmappedExample_after_NCL.fasta -outfmt 7 -evalue 1e-05 2>temp.txt  | awk '{if($13<1e-05 && ($1=="V" || $1=="J")) print }' >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//BCR//IGL/unmappedExample_IGL_igblast.csv
5b. T lymphocytes profiling...
/u/home/galaxy/collaboratory/serghei/code/rop/tools/igblastn -germline_db_V /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRAV.fa -germline_db_D /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRBD.fa  -germline_db_J /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRAJ.fa -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/NCL/unmappedExample_after_NCL.fasta -outfmt 7 -evalue 1e-05 2>temp.txt | awk '{if($13<1e-05 && ($1=="V" || $1=="J")) print }' >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//TCR//TCRA/unmappedExample_TCRA_igblast.csv
/u/home/galaxy/collaboratory/serghei/code/rop/tools/igblastn -germline_db_V /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRBV.fa -germline_db_D /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRBD.fa  -germline_db_J /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRBJ.fa -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/NCL/unmappedExample_after_NCL.fasta -outfmt 7 -evalue 1e-05 2>temp.txt  | awk '{if($13<1e-05 && ($1=="V" || $1=="J")) print }' >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//TCR//TCRB/unmappedExample_TCRB_igblast.csv
/u/home/galaxy/collaboratory/serghei/code/rop/tools/igblastn -germline_db_V /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRDV.fa -germline_db_D /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRBD.fa  -germline_db_J /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRDJ.fa -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/NCL/unmappedExample_after_NCL.fasta -outfmt 7 -evalue 1e-05 2>temp.txt  | awk '{if($13<1e-05 && ($1=="V" || $1=="J")) print }' >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//TCR//TCRD/unmappedExample_TCRD_igblast.csv
/u/home/galaxy/collaboratory/serghei/code/rop/tools/igblastn -germline_db_V /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRGV.fa -germline_db_D /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRBD.fa  -germline_db_J /u/home/galaxy/collaboratory/serghei/code/rop/db/antibody/TRGJ.fa -query /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/NCL/unmappedExample_after_NCL.fasta -outfmt 7 -evalue 1e-05 2>temp.txt  | awk '{if($13<1e-05 && ($1=="V" || $1=="J")) print }' >/u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//TCR//TCRG/unmappedExample_TCRG_igblast.csv
5.  Metaphlan profiling...
python /u/home/galaxy/collaboratory/serghei/code/rop/tools/metaphlan2.py /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/antibodyProfile//BCR/unmappedExample_afterImmune.fasta /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/microbiomeProfile//metaphlan/unmappedExample_metaphlan.map --mpa_pkl /u/home/galaxy/collaboratory/serghei/code/rop/db/metaphlan/mpa_v20_m200.pkl --bowtie2_exe /u/home/galaxy/collaboratory/serghei/code/rop/tools/bowtie2 --input_type multifasta --bowtie2db /u/home/galaxy/collaboratory/serghei/code/rop/db/metaphlan/mpa_v20_m200 -t reads_map --nproc 8 --bowtie2out /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/microbiomeProfile//metaphlan/unmappedExample_bowtie2out.txt
python /u/home/galaxy/collaboratory/serghei/code/rop/tools/metaphlan2.py --mpa_pkl /u/home/galaxy/collaboratory/serghei/code/rop/db/metaphlan/mpa_v20_m200.pkl --bowtie2_exe /u/home/galaxy/collaboratory/serghei/code/rop/tools/bowtie2 --input_type bowtie2out /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/microbiomeProfile//metaphlan/unmappedExample_bowtie2out.txt -t rel_ab > /u/home/galaxy/collaboratory/serghei/code/rop/example/ropOut4/microbiomeProfile//metaphlan/unmappedExample_metaphlan_output.tsv
